{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\THUY TRANG\\\\Downloads\\\\codqtmoi\\\\DoAn_QTCSDLHD\\\\qtcsdlhd__fe\\\\src\\\\ShoppingCart.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport './ShoppingCart.css';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nfunction ShoppingCart({\n  onPlaceOrder\n}) {\n  _s();\n  const [cartProducts, setCartProducts] = useState([]);\n  const [message, setMessage] = useState('');\n  const [messageTimeoutId, setMessageTimeoutId] = useState(null);\n  const [shippingAddress, setShippingAddress] = useState('');\n  const [paymentMethod, setPaymentMethod] = useState('Tiền mặt');\n  const [userAddresses, setUserAddresses] = useState([]);\n  const [selectedAddressIndex, setSelectedAddressIndex] = useState(-1);\n  const [fullName, setFullName] = useState('');\n  const [phoneNumber, setPhoneNumber] = useState('');\n  const [bankAccount, setBankAccount] = useState(null);\n  const [availableVouchers, setAvailableVouchers] = useState({});\n  const [selectedVouchers, setSelectedVouchers] = useState({});\n  const [selectedProductIds, setSelectedProductIds] = useState([]);\n  const hasAutoSelected = useRef(false);\n  const navigate = useNavigate();\n  const displayMessage = (msg, duration = 3000) => {\n    if (messageTimeoutId) {\n      clearTimeout(messageTimeoutId);\n    }\n    setMessage(msg);\n    const id = setTimeout(() => {\n      setMessage('');\n      setMessageTimeoutId(null);\n    }, duration);\n    setMessageTimeoutId(id);\n  };\n  const fetchUserProfile = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) return;\n      const response = await fetch('http://localhost:8080/api/users/me', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const data = await response.json();\n        setFullName(data.fullName || '');\n        if (data.buyerProfile) {\n          setPhoneNumber(data.buyerProfile.phoneNumber || '');\n          setBankAccount(data.buyerProfile.bankAccount || null);\n          if (data.buyerProfile.primaryAddress) {\n            const primaryAddress = data.buyerProfile.primaryAddress;\n            const formattedAddress = `${primaryAddress.street}, ${primaryAddress.ward}, ${primaryAddress.district}, ${primaryAddress.city}`;\n            setShippingAddress(formattedAddress);\n          }\n          if (data.buyerProfile.addresses) {\n            setUserAddresses(data.buyerProfile.addresses);\n          }\n        }\n      }\n    } catch (error) {\n      console.error('Error fetching user profile:', error);\n    }\n  };\n  const fetchCartProducts = async () => {\n    try {\n      const token = localStorage.getItem('token');\n      if (!token) {\n        displayMessage('Bạn cần đăng nhập để xem giỏ hàng.', 5000);\n        return;\n      }\n      const response = await fetch('http://localhost:8080/api/customers/cart', {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const data = await response.json();\n        setCartProducts(data);\n      } else {\n        const errorText = await response.text();\n        displayMessage(`Error fetching cart: ${errorText}`, 5000);\n      }\n    } catch (error) {\n      displayMessage(`Network error fetching cart: ${error.message}`, 5000);\n    }\n  };\n  const fetchVouchersForProduct = async productId => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch(`http://localhost:8080/api/vouchers/product/${productId}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        const vouchers = await response.json();\n        setAvailableVouchers(prev => ({\n          ...prev,\n          [productId]: vouchers\n        }));\n      } else {\n        console.error(`Failed to fetch vouchers for product ${productId}:`, response.status, response.statusText);\n      }\n    } catch (error) {\n      console.error('Error fetching vouchers:', error);\n    }\n  };\n  const handleVoucherSelect = (productId, voucherId) => {\n    setSelectedVouchers(prev => ({\n      ...prev,\n      [productId]: voucherId\n    }));\n  };\n  useEffect(() => {\n    fetchCartProducts();\n    fetchUserProfile();\n  }, []);\n  useEffect(() => {\n    cartProducts.forEach(product => {\n      fetchVouchersForProduct(product._id);\n    });\n    setSelectedProductIds(prev => {\n      // Filter out products that are now out of stock\n      const newSelectedIds = prev.filter(id => {\n        const productInCart = cartProducts.find(p => p._id === id);\n        return productInCart && productInCart.stock > 0;\n      });\n      if (!hasAutoSelected.current && newSelectedIds.length === 0 && cartProducts.length > 0) {\n        hasAutoSelected.current = true;\n        // Only auto-select products that are in stock\n        return cartProducts.filter(p => p.stock > 0).map(p => p._id);\n      }\n      return newSelectedIds;\n    });\n  }, [cartProducts]);\n  const handleUpdateQuantity = async (productId, quantity) => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch(`http://localhost:8080/api/customers/cart/update-quantity/${productId}/${quantity}`, {\n        method: 'PUT',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n      if (response.ok) {\n        fetchCartProducts();\n        displayMessage('Số lượng sản phẩm đã được cập nhật.');\n      } else {\n        const errorText = await response.text();\n        displayMessage(`Error updating quantity: ${errorText}`, 5000);\n      }\n    } catch (error) {\n      displayMessage(`Network error updating quantity: ${error.message}`, 5000);\n    }\n  };\n  const handleRemoveProduct = async productId => {\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch('http://localhost:8080/api/customers/cart/remove', {\n        method: 'DELETE',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          productId\n        })\n      });\n      if (response.ok) {\n        fetchCartProducts();\n        displayMessage('Sản phẩm đã được xóa khỏi giỏ hàng.');\n      } else {\n        const errorText = await response.text();\n        displayMessage(`Error removing product: ${errorText}`, 5000);\n      }\n    } catch (error) {\n      displayMessage(`Network error removing product: ${error.message}`, 5000);\n    }\n  };\n  const calculateItemTotal = item => {\n    const price = parseFloat(item.price);\n    const quantity = parseInt(item.quantity);\n    let total = price * quantity;\n\n    // Apply voucher discount if selected\n    const selectedVoucher = selectedVouchers[item._id];\n    const productVouchers = availableVouchers[item._id] || [];\n    const voucher = productVouchers.find(v => v.id === selectedVoucher);\n    if (voucher) {\n      // Check if minimum order value is met\n      const canUseVoucher = !voucher.minOrderValue || total >= voucher.minOrderValue;\n      if (canUseVoucher) {\n        if (voucher.discountType === 'PERCENTAGE') {\n          total = total * (1 - voucher.discountValue / 100);\n        } else if (voucher.discountType === 'FIXED') {\n          total = total - voucher.discountValue;\n        }\n      }\n    }\n    return total;\n  };\n  const calculateTotal = () => {\n    return cartProducts.reduce((sum, item) => {\n      if (!selectedProductIds.includes(item._id)) return sum;\n      return sum + calculateItemTotal(item);\n    }, 0);\n  };\n  const handlePlaceOrder = async e => {\n    e.preventDefault();\n    if (!shippingAddress || !paymentMethod || !fullName || !phoneNumber) {\n      displayMessage(\"Vui lòng điền đầy đủ thông tin giao hàng.\", 5000);\n      return;\n    }\n    if (paymentMethod === 'Thẻ ngân hàng' && !bankAccount) {\n      displayMessage(\"Vui lòng cập nhật thông tin tài khoản ngân hàng trong hồ sơ.\", 5000);\n      return;\n    }\n    if (selectedProductIds.length === 0) {\n      displayMessage(\"Vui lòng chọn ít nhất một sản phẩm để đặt hàng.\", 5000);\n      return;\n    }\n    const orderItems = cartProducts.filter(item => selectedProductIds.includes(item._id)).map(item => ({\n      productId: item._id,\n      quantity: parseInt(item.quantity),\n      voucherId: selectedVouchers[item._id]\n    }));\n    try {\n      const token = localStorage.getItem('token');\n      const response = await fetch('http://localhost:8080/api/customers/orders', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Authorization': `Bearer ${token}`\n        },\n        body: JSON.stringify({\n          fullName,\n          phoneNumber,\n          shippingAddress,\n          paymentMethod,\n          bankAccount: paymentMethod === 'Thẻ ngân hàng' ? bankAccount : null,\n          items: orderItems\n        })\n      });\n      if (response.ok) {\n        const orderId = await response.text();\n        setCartProducts([]);\n        setShippingAddress('');\n        setPaymentMethod('Tiền mặt');\n        setSelectedVouchers({});\n        onPlaceOrder(orderId);\n      } else {\n        const errorText = await response.text();\n        displayMessage(`Lỗi tạo đơn hàng: ${errorText}`, 5000);\n      }\n    } catch (error) {\n      displayMessage(`Lỗi mạng khi tạo đơn hàng: ${error.message}`, 5000);\n    }\n  };\n  const handleProductCheckbox = productId => {\n    setSelectedProductIds(prev => prev.includes(productId) ? prev.filter(id => id !== productId) : [...prev, productId]);\n  };\n  const handleSelectAll = e => {\n    if (e.target.checked) {\n      setSelectedProductIds(cartProducts.map(p => p._id));\n    } else {\n      setSelectedProductIds([]);\n    }\n  };\n  const handleGoToCheckout = () => {\n    navigate('/checkout', {\n      state: {\n        selectedVouchers,\n        selectedProductIds\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"shopping-cart-container\",\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: () => navigate(-1),\n      className: \"back-btn\",\n      children: [/*#__PURE__*/_jsxDEV(\"i\", {\n        className: \"fas fa-arrow-left\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 302,\n        columnNumber: 17\n      }, this), \" Quay l\\u1EA1i\"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 301,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Gi\\u1ECF h\\xE0ng c\\u1EE7a b\\u1EA1n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 304,\n      columnNumber: 13\n    }, this), message && /*#__PURE__*/_jsxDEV(\"p\", {\n      className: \"message error\",\n      children: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 25\n    }, this), cartProducts.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"cart-list\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cart-items-scroll\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            alignItems: 'center',\n            marginBottom: 10\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"checkbox\",\n            checked: selectedProductIds.length === cartProducts.length && cartProducts.length > 0,\n            onChange: handleSelectAll,\n            style: {\n              marginRight: 8\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"Ch\\u1ECDn t\\u1EA5t c\\u1EA3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 317,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 310,\n          columnNumber: 25\n        }, this), cartProducts.map(product => {\n          var _availableVouchers$pr;\n          return /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"cart-item\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: selectedProductIds.includes(product._id),\n              onChange: () => handleProductCheckbox(product._id),\n              disabled: product.stock === 0 /* Disable if stock is 0 */\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 321,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-thumbnail\",\n              style: product.image_url ? {\n                backgroundImage: `url(${product.image_url})`,\n                backgroundSize: 'cover',\n                backgroundRepeat: 'no-repeat',\n                backgroundPosition: 'center'\n              } : {},\n              children: [!product.image_url && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"no-image-thumbnail\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 335,\n                columnNumber: 60\n              }, this), product.stock === 0 && /*#__PURE__*/_jsxDEV(\"img\", {\n                src: \"/soldout.png\",\n                alt: \"Sold Out\",\n                className: \"sold-out-overlay\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 337,\n                columnNumber: 41\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"cart-item-details\",\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: product.name\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 341,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"product-shop-name\",\n                children: [\"C\\u1EEDa h\\xE0ng: \", product.shop_name]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 342,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"price\",\n                children: [product.price.toLocaleString('vi-VN'), \" VND\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 343,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"stock\",\n                children: [\"T\\u1ED3n kho: \", product.stock]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 344,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"actions\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"voucher-section\",\n                  children: ((_availableVouchers$pr = availableVouchers[product._id]) === null || _availableVouchers$pr === void 0 ? void 0 : _availableVouchers$pr.length) > 0 ? /*#__PURE__*/_jsxDEV(\"select\", {\n                    value: selectedVouchers[product._id] || '',\n                    onChange: e => handleVoucherSelect(product._id, e.target.value),\n                    className: \"voucher-select\",\n                    children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                      value: \"\",\n                      children: \"Ch\\u1ECDn voucher\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 353,\n                      columnNumber: 53\n                    }, this), (availableVouchers[product._id] || []).map(voucher => {\n                      const canUse = !voucher.minOrderValue || product.price * product.quantity >= voucher.minOrderValue;\n                      const displayText = voucher.discountType === 'PERCENTAGE' ? `Giảm ${voucher.discountValue}%` : `Giảm ${voucher.discountValue.toLocaleString('vi-VN')} VND`;\n                      const minOrderText = voucher.minOrderValue ? ` (Tối thiểu ${voucher.minOrderValue.toLocaleString('vi-VN')} VND)` : '';\n                      return /*#__PURE__*/_jsxDEV(\"option\", {\n                        value: voucher.id,\n                        disabled: !canUse,\n                        children: [displayText, minOrderText, !canUse ? ' - Không đủ điều kiện' : '']\n                      }, voucher.id, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 364,\n                        columnNumber: 61\n                      }, this);\n                    })]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 348,\n                    columnNumber: 49\n                  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"no-voucher-message\",\n                    children: \"Kh\\xF4ng c\\xF3 voucher kh\\u1EA3 d\\u1EE5ng\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 375,\n                    columnNumber: 49\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 346,\n                  columnNumber: 41\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 340,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"quantity-control\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleUpdateQuantity(product._id, product.quantity - 1),\n                children: \"-\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 383,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: product.quantity\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 384,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                onClick: () => handleUpdateQuantity(product._id, product.quantity + 1),\n                children: \"+\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 385,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 382,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"price-info\",\n              children: selectedVouchers[product._id] ? /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"original-price\",\n                  children: [(product.price * product.quantity).toLocaleString('vi-VN'), \" VND\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 390,\n                  columnNumber: 45\n                }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                  className: \"discounted-price\",\n                  children: [calculateItemTotal(product).toLocaleString('vi-VN'), \" VND\"]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 393,\n                  columnNumber: 45\n                }, this)]\n              }, void 0, true) : /*#__PURE__*/_jsxDEV(\"p\", {\n                className: \"normal-price\",\n                children: [(product.price * product.quantity).toLocaleString('vi-VN'), \" VND\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 398,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 387,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n              onClick: () => handleRemoveProduct(product._id),\n              className: \"remove-btn\",\n              children: \"X\\xF3a\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 403,\n              columnNumber: 33\n            }, this)]\n          }, product._id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 320,\n            columnNumber: 29\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 309,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"cart-total\",\n        children: [\"T\\u1ED5ng c\\u1ED9ng: \", calculateTotal().toLocaleString('vi-VN'), \" VND\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 407,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"place-order-btn\",\n        onClick: handleGoToCheckout,\n        disabled: selectedProductIds.length === 0,\n        children: \"\\u0110\\u1EB7t h\\xE0ng\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 308,\n      columnNumber: 17\n    }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Gi\\u1ECF h\\xE0ng tr\\u1ED1ng\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 413,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 300,\n    columnNumber: 9\n  }, this);\n}\n_s(ShoppingCart, \"xua+Mq8nYp5dn//lyXmZyrmskeQ=\", false, function () {\n  return [useNavigate];\n});\n_c = ShoppingCart;\nexport default ShoppingCart;\nvar _c;\n$RefreshReg$(_c, \"ShoppingCart\");","map":{"version":3,"names":["React","useState","useEffect","useRef","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","ShoppingCart","onPlaceOrder","_s","cartProducts","setCartProducts","message","setMessage","messageTimeoutId","setMessageTimeoutId","shippingAddress","setShippingAddress","paymentMethod","setPaymentMethod","userAddresses","setUserAddresses","selectedAddressIndex","setSelectedAddressIndex","fullName","setFullName","phoneNumber","setPhoneNumber","bankAccount","setBankAccount","availableVouchers","setAvailableVouchers","selectedVouchers","setSelectedVouchers","selectedProductIds","setSelectedProductIds","hasAutoSelected","navigate","displayMessage","msg","duration","clearTimeout","id","setTimeout","fetchUserProfile","token","localStorage","getItem","response","fetch","headers","ok","data","json","buyerProfile","primaryAddress","formattedAddress","street","ward","district","city","addresses","error","console","fetchCartProducts","errorText","text","fetchVouchersForProduct","productId","vouchers","prev","status","statusText","handleVoucherSelect","voucherId","forEach","product","_id","newSelectedIds","filter","productInCart","find","p","stock","current","length","map","handleUpdateQuantity","quantity","method","handleRemoveProduct","body","JSON","stringify","calculateItemTotal","item","price","parseFloat","parseInt","total","selectedVoucher","productVouchers","voucher","v","canUseVoucher","minOrderValue","discountType","discountValue","calculateTotal","reduce","sum","includes","handlePlaceOrder","e","preventDefault","orderItems","items","orderId","handleProductCheckbox","handleSelectAll","target","checked","handleGoToCheckout","state","className","children","onClick","fileName","_jsxFileName","lineNumber","columnNumber","style","display","alignItems","marginBottom","type","onChange","marginRight","_availableVouchers$pr","disabled","image_url","backgroundImage","backgroundSize","backgroundRepeat","backgroundPosition","src","alt","name","shop_name","toLocaleString","value","canUse","displayText","minOrderText","_c","$RefreshReg$"],"sources":["C:/Users/THUY TRANG/Downloads/codqtmoi/DoAn_QTCSDLHD/qtcsdlhd__fe/src/ShoppingCart.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport './ShoppingCart.css';\r\nimport { useNavigate } from 'react-router-dom';\r\n\r\nfunction ShoppingCart({ onPlaceOrder }) {\r\n    const [cartProducts, setCartProducts] = useState([]);\r\n    const [message, setMessage] = useState('');\r\n    const [messageTimeoutId, setMessageTimeoutId] = useState(null);\r\n    const [shippingAddress, setShippingAddress] = useState('');\r\n    const [paymentMethod, setPaymentMethod] = useState('Tiền mặt');\r\n    const [userAddresses, setUserAddresses] = useState([]);\r\n    const [selectedAddressIndex, setSelectedAddressIndex] = useState(-1);\r\n    const [fullName, setFullName] = useState('');\r\n    const [phoneNumber, setPhoneNumber] = useState('');\r\n    const [bankAccount, setBankAccount] = useState(null);\r\n    const [availableVouchers, setAvailableVouchers] = useState({});\r\n    const [selectedVouchers, setSelectedVouchers] = useState({});\r\n    const [selectedProductIds, setSelectedProductIds] = useState([]);\r\n    const hasAutoSelected = useRef(false);\r\n    const navigate = useNavigate();\r\n\r\n    const displayMessage = (msg, duration = 3000) => {\r\n        if (messageTimeoutId) {\r\n            clearTimeout(messageTimeoutId);\r\n        }\r\n        setMessage(msg);\r\n        const id = setTimeout(() => {\r\n            setMessage('');\r\n            setMessageTimeoutId(null);\r\n        }, duration);\r\n        setMessageTimeoutId(id);\r\n    };\r\n\r\n    const fetchUserProfile = async () => {\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            if (!token) return;\r\n\r\n            const response = await fetch('http://localhost:8080/api/users/me', {\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            });\r\n\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setFullName(data.fullName || '');\r\n\r\n                if (data.buyerProfile) {\r\n                    setPhoneNumber(data.buyerProfile.phoneNumber || '');\r\n                    setBankAccount(data.buyerProfile.bankAccount || null);\r\n\r\n                    if (data.buyerProfile.primaryAddress) {\r\n                        const primaryAddress = data.buyerProfile.primaryAddress;\r\n                        const formattedAddress = `${primaryAddress.street}, ${primaryAddress.ward}, ${primaryAddress.district}, ${primaryAddress.city}`;\r\n                        setShippingAddress(formattedAddress);\r\n                    }\r\n\r\n                    if (data.buyerProfile.addresses) {\r\n                        setUserAddresses(data.buyerProfile.addresses);\r\n                    }\r\n                }\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching user profile:', error);\r\n        }\r\n    };\r\n\r\n    const fetchCartProducts = async () => {\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            if (!token) {\r\n                displayMessage('Bạn cần đăng nhập để xem giỏ hàng.', 5000);\r\n                return;\r\n            }\r\n            const response = await fetch('http://localhost:8080/api/customers/cart', {\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            });\r\n\r\n            if (response.ok) {\r\n                const data = await response.json();\r\n                setCartProducts(data);\r\n            } else {\r\n                const errorText = await response.text();\r\n                displayMessage(`Error fetching cart: ${errorText}`, 5000);\r\n            }\r\n        } catch (error) {\r\n            displayMessage(`Network error fetching cart: ${error.message}`, 5000);\r\n        }\r\n    };\r\n\r\n    const fetchVouchersForProduct = async (productId) => {\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            const response = await fetch(`http://localhost:8080/api/vouchers/product/${productId}`, {\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            });\r\n            if (response.ok) {\r\n                const vouchers = await response.json();\r\n                setAvailableVouchers(prev => ({\r\n                    ...prev,\r\n                    [productId]: vouchers\r\n                }));\r\n            } else {\r\n                console.error(`Failed to fetch vouchers for product ${productId}:`, response.status, response.statusText);\r\n            }\r\n        } catch (error) {\r\n            console.error('Error fetching vouchers:', error);\r\n        }\r\n    };\r\n\r\n    const handleVoucherSelect = (productId, voucherId) => {\r\n        setSelectedVouchers(prev => ({\r\n            ...prev,\r\n            [productId]: voucherId\r\n        }));\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchCartProducts();\r\n        fetchUserProfile();\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        cartProducts.forEach(product => {\r\n            fetchVouchersForProduct(product._id);\r\n        });\r\n        setSelectedProductIds(prev => {\r\n            // Filter out products that are now out of stock\r\n            const newSelectedIds = prev.filter(id => {\r\n                const productInCart = cartProducts.find(p => p._id === id);\r\n                return productInCart && productInCart.stock > 0;\r\n            });\r\n\r\n            if (!hasAutoSelected.current && newSelectedIds.length === 0 && cartProducts.length > 0) {\r\n                hasAutoSelected.current = true;\r\n                // Only auto-select products that are in stock\r\n                return cartProducts.filter(p => p.stock > 0).map(p => p._id);\r\n            }\r\n            return newSelectedIds;\r\n        });\r\n    }, [cartProducts]);\r\n\r\n    const handleUpdateQuantity = async (productId, quantity) => {\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            const response = await fetch(`http://localhost:8080/api/customers/cart/update-quantity/${productId}/${quantity}`, {\r\n                method: 'PUT',\r\n                headers: {\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            });\r\n            if (response.ok) {\r\n                fetchCartProducts();\r\n                displayMessage('Số lượng sản phẩm đã được cập nhật.');\r\n            } else {\r\n                const errorText = await response.text();\r\n                displayMessage(`Error updating quantity: ${errorText}`, 5000);\r\n            }\r\n        } catch (error) {\r\n            displayMessage(`Network error updating quantity: ${error.message}`, 5000);\r\n        }\r\n    };\r\n\r\n    const handleRemoveProduct = async (productId) => {\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            const response = await fetch('http://localhost:8080/api/customers/cart/remove', {\r\n                method: 'DELETE',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                },\r\n                body: JSON.stringify({ productId })\r\n            });\r\n            if (response.ok) {\r\n                fetchCartProducts();\r\n                displayMessage('Sản phẩm đã được xóa khỏi giỏ hàng.');\r\n            } else {\r\n                const errorText = await response.text();\r\n                displayMessage(`Error removing product: ${errorText}`, 5000);\r\n            }\r\n        } catch (error) {\r\n            displayMessage(`Network error removing product: ${error.message}`, 5000);\r\n        }\r\n    };\r\n\r\n    const calculateItemTotal = (item) => {\r\n        const price = parseFloat(item.price);\r\n        const quantity = parseInt(item.quantity);\r\n        let total = price * quantity;\r\n\r\n        // Apply voucher discount if selected\r\n        const selectedVoucher = selectedVouchers[item._id];\r\n        const productVouchers = availableVouchers[item._id] || [];\r\n        const voucher = productVouchers.find(v => v.id === selectedVoucher);\r\n\r\n        if (voucher) {\r\n            // Check if minimum order value is met\r\n            const canUseVoucher = !voucher.minOrderValue || total >= voucher.minOrderValue;\r\n\r\n            if (canUseVoucher) {\r\n                if (voucher.discountType === 'PERCENTAGE') {\r\n                    total = total * (1 - voucher.discountValue / 100);\r\n                } else if (voucher.discountType === 'FIXED') {\r\n                    total = total - voucher.discountValue;\r\n                }\r\n            }\r\n        }\r\n\r\n        return total;\r\n    };\r\n\r\n    const calculateTotal = () => {\r\n        return cartProducts.reduce((sum, item) => {\r\n            if (!selectedProductIds.includes(item._id)) return sum;\r\n            return sum + calculateItemTotal(item);\r\n        }, 0);\r\n    };\r\n\r\n    const handlePlaceOrder = async (e) => {\r\n        e.preventDefault();\r\n        if (!shippingAddress || !paymentMethod || !fullName || !phoneNumber) {\r\n            displayMessage(\"Vui lòng điền đầy đủ thông tin giao hàng.\", 5000);\r\n            return;\r\n        }\r\n        if (paymentMethod === 'Thẻ ngân hàng' && !bankAccount) {\r\n            displayMessage(\"Vui lòng cập nhật thông tin tài khoản ngân hàng trong hồ sơ.\", 5000);\r\n            return;\r\n        }\r\n        if (selectedProductIds.length === 0) {\r\n            displayMessage(\"Vui lòng chọn ít nhất một sản phẩm để đặt hàng.\", 5000);\r\n            return;\r\n        }\r\n        const orderItems = cartProducts.filter(item => selectedProductIds.includes(item._id)).map(item => ({\r\n            productId: item._id,\r\n            quantity: parseInt(item.quantity),\r\n            voucherId: selectedVouchers[item._id]\r\n        }));\r\n\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            const response = await fetch('http://localhost:8080/api/customers/orders', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                    'Authorization': `Bearer ${token}`\r\n                },\r\n                body: JSON.stringify({\r\n                    fullName,\r\n                    phoneNumber,\r\n                    shippingAddress,\r\n                    paymentMethod,\r\n                    bankAccount: paymentMethod === 'Thẻ ngân hàng' ? bankAccount : null,\r\n                    items: orderItems\r\n                })\r\n            });\r\n\r\n            if (response.ok) {\r\n                const orderId = await response.text();\r\n                setCartProducts([]);\r\n                setShippingAddress('');\r\n                setPaymentMethod('Tiền mặt');\r\n                setSelectedVouchers({});\r\n                onPlaceOrder(orderId);\r\n            } else {\r\n                const errorText = await response.text();\r\n                displayMessage(`Lỗi tạo đơn hàng: ${errorText}`, 5000);\r\n            }\r\n        } catch (error) {\r\n            displayMessage(`Lỗi mạng khi tạo đơn hàng: ${error.message}`, 5000);\r\n        }\r\n    };\r\n\r\n    const handleProductCheckbox = (productId) => {\r\n        setSelectedProductIds(prev =>\r\n            prev.includes(productId)\r\n                ? prev.filter(id => id !== productId)\r\n                : [...prev, productId]\r\n        );\r\n    };\r\n\r\n    const handleSelectAll = (e) => {\r\n        if (e.target.checked) {\r\n            setSelectedProductIds(cartProducts.map(p => p._id));\r\n        } else {\r\n            setSelectedProductIds([]);\r\n        }\r\n    };\r\n\r\n    const handleGoToCheckout = () => {\r\n        navigate('/checkout', { state: { selectedVouchers, selectedProductIds } });\r\n    };\r\n\r\n    return (\r\n        <div className=\"shopping-cart-container\">\r\n            <button onClick={() => navigate(-1)} className=\"back-btn\">\r\n                <i className=\"fas fa-arrow-left\"></i> Quay lại\r\n            </button>\r\n            <h2>Giỏ hàng của bạn</h2>\r\n            {message && <p className=\"message error\">{message}</p>}\r\n\r\n            {cartProducts.length > 0 ? (\r\n                <div className=\"cart-list\">\r\n                    <div className=\"cart-items-scroll\">\r\n                        <div style={{ display: 'flex', alignItems: 'center', marginBottom: 10 }}>\r\n                            <input\r\n                                type=\"checkbox\"\r\n                                checked={selectedProductIds.length === cartProducts.length && cartProducts.length > 0}\r\n                                onChange={handleSelectAll}\r\n                                style={{ marginRight: 8 }}\r\n                            />\r\n                            <span>Chọn tất cả</span>\r\n                        </div>\r\n                        {cartProducts.map(product => (\r\n                            <div key={product._id} className=\"cart-item\">\r\n                                <input\r\n                                    type=\"checkbox\"\r\n                                    checked={selectedProductIds.includes(product._id)}\r\n                                    onChange={() => handleProductCheckbox(product._id)}\r\n                                    disabled={product.stock === 0} /* Disable if stock is 0 */\r\n                                />\r\n                                <div\r\n                                    className=\"product-thumbnail\"\r\n                                    style={product.image_url ? {\r\n                                        backgroundImage: `url(${product.image_url})`,\r\n                                        backgroundSize: 'cover',\r\n                                        backgroundRepeat: 'no-repeat',\r\n                                        backgroundPosition: 'center',\r\n                                    } : {}}>\r\n                                    {!product.image_url && <div className=\"no-image-thumbnail\"></div>}\r\n                                    {product.stock === 0 && (\r\n                                        <img src=\"/soldout.png\" alt=\"Sold Out\" className=\"sold-out-overlay\" />\r\n                                    )}\r\n                                </div>\r\n                                <div className=\"cart-item-details\">\r\n                                    <h3>{product.name}</h3>\r\n                                    <p className=\"product-shop-name\">Cửa hàng: {product.shop_name}</p>\r\n                                    <p className=\"price\">{product.price.toLocaleString('vi-VN')} VND</p>\r\n                                    <p className=\"stock\">Tồn kho: {product.stock}</p>\r\n                                    <div className=\"actions\">\r\n                                        <div className=\"voucher-section\">\r\n                                            {(availableVouchers[product._id]?.length > 0) ? (\r\n                                                <select\r\n                                                    value={selectedVouchers[product._id] || ''}\r\n                                                    onChange={(e) => handleVoucherSelect(product._id, e.target.value)}\r\n                                                    className=\"voucher-select\"\r\n                                                >\r\n                                                    <option value=\"\">Chọn voucher</option>\r\n                                                    {(availableVouchers[product._id] || []).map(voucher => {\r\n                                                        const canUse = !voucher.minOrderValue || (product.price * product.quantity) >= voucher.minOrderValue;\r\n                                                        const displayText = voucher.discountType === 'PERCENTAGE'\r\n                                                            ? `Giảm ${voucher.discountValue}%`\r\n                                                            : `Giảm ${voucher.discountValue.toLocaleString('vi-VN')} VND`;\r\n                                                        const minOrderText = voucher.minOrderValue\r\n                                                            ? ` (Tối thiểu ${voucher.minOrderValue.toLocaleString('vi-VN')} VND)`\r\n                                                            : '';\r\n\r\n                                                        return (\r\n                                                            <option\r\n                                                                key={voucher.id}\r\n                                                                value={voucher.id}\r\n                                                                disabled={!canUse}\r\n                                                            >\r\n                                                                {displayText}{minOrderText}{!canUse ? ' - Không đủ điều kiện' : ''}\r\n                                                            </option>\r\n                                                        );\r\n                                                    })}\r\n                                                </select>\r\n                                            ) : (\r\n                                                <div className=\"no-voucher-message\">\r\n                                                    Không có voucher khả dụng\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                                <div className=\"quantity-control\">\r\n                                    <button onClick={() => handleUpdateQuantity(product._id, product.quantity - 1)}>-</button>\r\n                                    <span>{product.quantity}</span>\r\n                                    <button onClick={() => handleUpdateQuantity(product._id, product.quantity + 1)}>+</button>\r\n                                </div>\r\n                                <div className=\"price-info\">\r\n                                    {selectedVouchers[product._id] ? (\r\n                                        <>\r\n                                            <p className=\"original-price\">\r\n                                                {(product.price * product.quantity).toLocaleString('vi-VN')} VND\r\n                                            </p>\r\n                                            <p className=\"discounted-price\">\r\n                                                {calculateItemTotal(product).toLocaleString('vi-VN')} VND\r\n                                            </p>\r\n                                        </>\r\n                                    ) : (\r\n                                        <p className=\"normal-price\">\r\n                                            {(product.price * product.quantity).toLocaleString('vi-VN')} VND\r\n                                        </p>\r\n                                    )}\r\n                                </div>\r\n                                <button onClick={() => handleRemoveProduct(product._id)} className=\"remove-btn\">Xóa</button>\r\n                            </div>\r\n                        ))}\r\n                    </div>\r\n                    <h3 className=\"cart-total\">Tổng cộng: {calculateTotal().toLocaleString('vi-VN')} VND</h3>\r\n                    <button className=\"place-order-btn\" onClick={handleGoToCheckout} disabled={selectedProductIds.length === 0}>\r\n                        Đặt hàng\r\n                    </button>\r\n                </div>\r\n            ) : (\r\n                <p>Giỏ hàng trống</p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ShoppingCart;"],"mappings":";;AAAA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,MAAM,QAAQ,OAAO;AAC1D,OAAO,oBAAoB;AAC3B,SAASC,WAAW,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA,EAAAC,QAAA,IAAAC,SAAA;AAE/C,SAASC,YAAYA,CAAC;EAAEC;AAAa,CAAC,EAAE;EAAAC,EAAA;EACpC,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGZ,QAAQ,CAAC,EAAE,CAAC;EACpD,MAAM,CAACa,OAAO,EAAEC,UAAU,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC;EAC1C,MAAM,CAACe,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGhB,QAAQ,CAAC,IAAI,CAAC;EAC9D,MAAM,CAACiB,eAAe,EAAEC,kBAAkB,CAAC,GAAGlB,QAAQ,CAAC,EAAE,CAAC;EAC1D,MAAM,CAACmB,aAAa,EAAEC,gBAAgB,CAAC,GAAGpB,QAAQ,CAAC,UAAU,CAAC;EAC9D,MAAM,CAACqB,aAAa,EAAEC,gBAAgB,CAAC,GAAGtB,QAAQ,CAAC,EAAE,CAAC;EACtD,MAAM,CAACuB,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGxB,QAAQ,CAAC,CAAC,CAAC,CAAC;EACpE,MAAM,CAACyB,QAAQ,EAAEC,WAAW,CAAC,GAAG1B,QAAQ,CAAC,EAAE,CAAC;EAC5C,MAAM,CAAC2B,WAAW,EAAEC,cAAc,CAAC,GAAG5B,QAAQ,CAAC,EAAE,CAAC;EAClD,MAAM,CAAC6B,WAAW,EAAEC,cAAc,CAAC,GAAG9B,QAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAAC+B,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGhC,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC9D,MAAM,CAACiC,gBAAgB,EAAEC,mBAAmB,CAAC,GAAGlC,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC5D,MAAM,CAACmC,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGpC,QAAQ,CAAC,EAAE,CAAC;EAChE,MAAMqC,eAAe,GAAGnC,MAAM,CAAC,KAAK,CAAC;EACrC,MAAMoC,QAAQ,GAAGnC,WAAW,CAAC,CAAC;EAE9B,MAAMoC,cAAc,GAAGA,CAACC,GAAG,EAAEC,QAAQ,GAAG,IAAI,KAAK;IAC7C,IAAI1B,gBAAgB,EAAE;MAClB2B,YAAY,CAAC3B,gBAAgB,CAAC;IAClC;IACAD,UAAU,CAAC0B,GAAG,CAAC;IACf,MAAMG,EAAE,GAAGC,UAAU,CAAC,MAAM;MACxB9B,UAAU,CAAC,EAAE,CAAC;MACdE,mBAAmB,CAAC,IAAI,CAAC;IAC7B,CAAC,EAAEyB,QAAQ,CAAC;IACZzB,mBAAmB,CAAC2B,EAAE,CAAC;EAC3B,CAAC;EAED,MAAME,gBAAgB,GAAG,MAAAA,CAAA,KAAY;IACjC,IAAI;MACA,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAI,CAACF,KAAK,EAAE;MAEZ,MAAMG,QAAQ,GAAG,MAAMC,KAAK,CAAC,oCAAoC,EAAE;QAC/DC,OAAO,EAAE;UACL,eAAe,EAAE,UAAUL,KAAK;QACpC;MACJ,CAAC,CAAC;MAEF,IAAIG,QAAQ,CAACG,EAAE,EAAE;QACb,MAAMC,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAI,CAAC,CAAC;QAClC5B,WAAW,CAAC2B,IAAI,CAAC5B,QAAQ,IAAI,EAAE,CAAC;QAEhC,IAAI4B,IAAI,CAACE,YAAY,EAAE;UACnB3B,cAAc,CAACyB,IAAI,CAACE,YAAY,CAAC5B,WAAW,IAAI,EAAE,CAAC;UACnDG,cAAc,CAACuB,IAAI,CAACE,YAAY,CAAC1B,WAAW,IAAI,IAAI,CAAC;UAErD,IAAIwB,IAAI,CAACE,YAAY,CAACC,cAAc,EAAE;YAClC,MAAMA,cAAc,GAAGH,IAAI,CAACE,YAAY,CAACC,cAAc;YACvD,MAAMC,gBAAgB,GAAG,GAAGD,cAAc,CAACE,MAAM,KAAKF,cAAc,CAACG,IAAI,KAAKH,cAAc,CAACI,QAAQ,KAAKJ,cAAc,CAACK,IAAI,EAAE;YAC/H3C,kBAAkB,CAACuC,gBAAgB,CAAC;UACxC;UAEA,IAAIJ,IAAI,CAACE,YAAY,CAACO,SAAS,EAAE;YAC7BxC,gBAAgB,CAAC+B,IAAI,CAACE,YAAY,CAACO,SAAS,CAAC;UACjD;QACJ;MACJ;IACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;IACxD;EACJ,CAAC;EAED,MAAME,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IAClC,IAAI;MACA,MAAMnB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAI,CAACF,KAAK,EAAE;QACRP,cAAc,CAAC,oCAAoC,EAAE,IAAI,CAAC;QAC1D;MACJ;MACA,MAAMU,QAAQ,GAAG,MAAMC,KAAK,CAAC,0CAA0C,EAAE;QACrEC,OAAO,EAAE;UACL,eAAe,EAAE,UAAUL,KAAK;QACpC;MACJ,CAAC,CAAC;MAEF,IAAIG,QAAQ,CAACG,EAAE,EAAE;QACb,MAAMC,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAI,CAAC,CAAC;QAClC1C,eAAe,CAACyC,IAAI,CAAC;MACzB,CAAC,MAAM;QACH,MAAMa,SAAS,GAAG,MAAMjB,QAAQ,CAACkB,IAAI,CAAC,CAAC;QACvC5B,cAAc,CAAC,wBAAwB2B,SAAS,EAAE,EAAE,IAAI,CAAC;MAC7D;IACJ,CAAC,CAAC,OAAOH,KAAK,EAAE;MACZxB,cAAc,CAAC,gCAAgCwB,KAAK,CAAClD,OAAO,EAAE,EAAE,IAAI,CAAC;IACzE;EACJ,CAAC;EAED,MAAMuD,uBAAuB,GAAG,MAAOC,SAAS,IAAK;IACjD,IAAI;MACA,MAAMvB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,8CAA8CmB,SAAS,EAAE,EAAE;QACpFlB,OAAO,EAAE;UACL,eAAe,EAAE,UAAUL,KAAK;QACpC;MACJ,CAAC,CAAC;MACF,IAAIG,QAAQ,CAACG,EAAE,EAAE;QACb,MAAMkB,QAAQ,GAAG,MAAMrB,QAAQ,CAACK,IAAI,CAAC,CAAC;QACtCtB,oBAAoB,CAACuC,IAAI,KAAK;UAC1B,GAAGA,IAAI;UACP,CAACF,SAAS,GAAGC;QACjB,CAAC,CAAC,CAAC;MACP,CAAC,MAAM;QACHN,OAAO,CAACD,KAAK,CAAC,wCAAwCM,SAAS,GAAG,EAAEpB,QAAQ,CAACuB,MAAM,EAAEvB,QAAQ,CAACwB,UAAU,CAAC;MAC7G;IACJ,CAAC,CAAC,OAAOV,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAK,CAAC;IACpD;EACJ,CAAC;EAED,MAAMW,mBAAmB,GAAGA,CAACL,SAAS,EAAEM,SAAS,KAAK;IAClDzC,mBAAmB,CAACqC,IAAI,KAAK;MACzB,GAAGA,IAAI;MACP,CAACF,SAAS,GAAGM;IACjB,CAAC,CAAC,CAAC;EACP,CAAC;EAED1E,SAAS,CAAC,MAAM;IACZgE,iBAAiB,CAAC,CAAC;IACnBpB,gBAAgB,CAAC,CAAC;EACtB,CAAC,EAAE,EAAE,CAAC;EAEN5C,SAAS,CAAC,MAAM;IACZU,YAAY,CAACiE,OAAO,CAACC,OAAO,IAAI;MAC5BT,uBAAuB,CAACS,OAAO,CAACC,GAAG,CAAC;IACxC,CAAC,CAAC;IACF1C,qBAAqB,CAACmC,IAAI,IAAI;MAC1B;MACA,MAAMQ,cAAc,GAAGR,IAAI,CAACS,MAAM,CAACrC,EAAE,IAAI;QACrC,MAAMsC,aAAa,GAAGtE,YAAY,CAACuE,IAAI,CAACC,CAAC,IAAIA,CAAC,CAACL,GAAG,KAAKnC,EAAE,CAAC;QAC1D,OAAOsC,aAAa,IAAIA,aAAa,CAACG,KAAK,GAAG,CAAC;MACnD,CAAC,CAAC;MAEF,IAAI,CAAC/C,eAAe,CAACgD,OAAO,IAAIN,cAAc,CAACO,MAAM,KAAK,CAAC,IAAI3E,YAAY,CAAC2E,MAAM,GAAG,CAAC,EAAE;QACpFjD,eAAe,CAACgD,OAAO,GAAG,IAAI;QAC9B;QACA,OAAO1E,YAAY,CAACqE,MAAM,CAACG,CAAC,IAAIA,CAAC,CAACC,KAAK,GAAG,CAAC,CAAC,CAACG,GAAG,CAACJ,CAAC,IAAIA,CAAC,CAACL,GAAG,CAAC;MAChE;MACA,OAAOC,cAAc;IACzB,CAAC,CAAC;EACN,CAAC,EAAE,CAACpE,YAAY,CAAC,CAAC;EAElB,MAAM6E,oBAAoB,GAAG,MAAAA,CAAOnB,SAAS,EAAEoB,QAAQ,KAAK;IACxD,IAAI;MACA,MAAM3C,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4DAA4DmB,SAAS,IAAIoB,QAAQ,EAAE,EAAE;QAC9GC,MAAM,EAAE,KAAK;QACbvC,OAAO,EAAE;UACL,eAAe,EAAE,UAAUL,KAAK;QACpC;MACJ,CAAC,CAAC;MACF,IAAIG,QAAQ,CAACG,EAAE,EAAE;QACba,iBAAiB,CAAC,CAAC;QACnB1B,cAAc,CAAC,qCAAqC,CAAC;MACzD,CAAC,MAAM;QACH,MAAM2B,SAAS,GAAG,MAAMjB,QAAQ,CAACkB,IAAI,CAAC,CAAC;QACvC5B,cAAc,CAAC,4BAA4B2B,SAAS,EAAE,EAAE,IAAI,CAAC;MACjE;IACJ,CAAC,CAAC,OAAOH,KAAK,EAAE;MACZxB,cAAc,CAAC,oCAAoCwB,KAAK,CAAClD,OAAO,EAAE,EAAE,IAAI,CAAC;IAC7E;EACJ,CAAC;EAED,MAAM8E,mBAAmB,GAAG,MAAOtB,SAAS,IAAK;IAC7C,IAAI;MACA,MAAMvB,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,iDAAiD,EAAE;QAC5EwC,MAAM,EAAE,QAAQ;QAChBvC,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,eAAe,EAAE,UAAUL,KAAK;QACpC,CAAC;QACD8C,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEzB;QAAU,CAAC;MACtC,CAAC,CAAC;MACF,IAAIpB,QAAQ,CAACG,EAAE,EAAE;QACba,iBAAiB,CAAC,CAAC;QACnB1B,cAAc,CAAC,qCAAqC,CAAC;MACzD,CAAC,MAAM;QACH,MAAM2B,SAAS,GAAG,MAAMjB,QAAQ,CAACkB,IAAI,CAAC,CAAC;QACvC5B,cAAc,CAAC,2BAA2B2B,SAAS,EAAE,EAAE,IAAI,CAAC;MAChE;IACJ,CAAC,CAAC,OAAOH,KAAK,EAAE;MACZxB,cAAc,CAAC,mCAAmCwB,KAAK,CAAClD,OAAO,EAAE,EAAE,IAAI,CAAC;IAC5E;EACJ,CAAC;EAED,MAAMkF,kBAAkB,GAAIC,IAAI,IAAK;IACjC,MAAMC,KAAK,GAAGC,UAAU,CAACF,IAAI,CAACC,KAAK,CAAC;IACpC,MAAMR,QAAQ,GAAGU,QAAQ,CAACH,IAAI,CAACP,QAAQ,CAAC;IACxC,IAAIW,KAAK,GAAGH,KAAK,GAAGR,QAAQ;;IAE5B;IACA,MAAMY,eAAe,GAAGpE,gBAAgB,CAAC+D,IAAI,CAAClB,GAAG,CAAC;IAClD,MAAMwB,eAAe,GAAGvE,iBAAiB,CAACiE,IAAI,CAAClB,GAAG,CAAC,IAAI,EAAE;IACzD,MAAMyB,OAAO,GAAGD,eAAe,CAACpB,IAAI,CAACsB,CAAC,IAAIA,CAAC,CAAC7D,EAAE,KAAK0D,eAAe,CAAC;IAEnE,IAAIE,OAAO,EAAE;MACT;MACA,MAAME,aAAa,GAAG,CAACF,OAAO,CAACG,aAAa,IAAIN,KAAK,IAAIG,OAAO,CAACG,aAAa;MAE9E,IAAID,aAAa,EAAE;QACf,IAAIF,OAAO,CAACI,YAAY,KAAK,YAAY,EAAE;UACvCP,KAAK,GAAGA,KAAK,IAAI,CAAC,GAAGG,OAAO,CAACK,aAAa,GAAG,GAAG,CAAC;QACrD,CAAC,MAAM,IAAIL,OAAO,CAACI,YAAY,KAAK,OAAO,EAAE;UACzCP,KAAK,GAAGA,KAAK,GAAGG,OAAO,CAACK,aAAa;QACzC;MACJ;IACJ;IAEA,OAAOR,KAAK;EAChB,CAAC;EAED,MAAMS,cAAc,GAAGA,CAAA,KAAM;IACzB,OAAOlG,YAAY,CAACmG,MAAM,CAAC,CAACC,GAAG,EAAEf,IAAI,KAAK;MACtC,IAAI,CAAC7D,kBAAkB,CAAC6E,QAAQ,CAAChB,IAAI,CAAClB,GAAG,CAAC,EAAE,OAAOiC,GAAG;MACtD,OAAOA,GAAG,GAAGhB,kBAAkB,CAACC,IAAI,CAAC;IACzC,CAAC,EAAE,CAAC,CAAC;EACT,CAAC;EAED,MAAMiB,gBAAgB,GAAG,MAAOC,CAAC,IAAK;IAClCA,CAAC,CAACC,cAAc,CAAC,CAAC;IAClB,IAAI,CAAClG,eAAe,IAAI,CAACE,aAAa,IAAI,CAACM,QAAQ,IAAI,CAACE,WAAW,EAAE;MACjEY,cAAc,CAAC,2CAA2C,EAAE,IAAI,CAAC;MACjE;IACJ;IACA,IAAIpB,aAAa,KAAK,eAAe,IAAI,CAACU,WAAW,EAAE;MACnDU,cAAc,CAAC,8DAA8D,EAAE,IAAI,CAAC;MACpF;IACJ;IACA,IAAIJ,kBAAkB,CAACmD,MAAM,KAAK,CAAC,EAAE;MACjC/C,cAAc,CAAC,iDAAiD,EAAE,IAAI,CAAC;MACvE;IACJ;IACA,MAAM6E,UAAU,GAAGzG,YAAY,CAACqE,MAAM,CAACgB,IAAI,IAAI7D,kBAAkB,CAAC6E,QAAQ,CAAChB,IAAI,CAAClB,GAAG,CAAC,CAAC,CAACS,GAAG,CAACS,IAAI,KAAK;MAC/F3B,SAAS,EAAE2B,IAAI,CAAClB,GAAG;MACnBW,QAAQ,EAAEU,QAAQ,CAACH,IAAI,CAACP,QAAQ,CAAC;MACjCd,SAAS,EAAE1C,gBAAgB,CAAC+D,IAAI,CAAClB,GAAG;IACxC,CAAC,CAAC,CAAC;IAEH,IAAI;MACA,MAAMhC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAAC,4CAA4C,EAAE;QACvEwC,MAAM,EAAE,MAAM;QACdvC,OAAO,EAAE;UACL,cAAc,EAAE,kBAAkB;UAClC,eAAe,EAAE,UAAUL,KAAK;QACpC,CAAC;QACD8C,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UACjBrE,QAAQ;UACRE,WAAW;UACXV,eAAe;UACfE,aAAa;UACbU,WAAW,EAAEV,aAAa,KAAK,eAAe,GAAGU,WAAW,GAAG,IAAI;UACnEwF,KAAK,EAAED;QACX,CAAC;MACL,CAAC,CAAC;MAEF,IAAInE,QAAQ,CAACG,EAAE,EAAE;QACb,MAAMkE,OAAO,GAAG,MAAMrE,QAAQ,CAACkB,IAAI,CAAC,CAAC;QACrCvD,eAAe,CAAC,EAAE,CAAC;QACnBM,kBAAkB,CAAC,EAAE,CAAC;QACtBE,gBAAgB,CAAC,UAAU,CAAC;QAC5Bc,mBAAmB,CAAC,CAAC,CAAC,CAAC;QACvBzB,YAAY,CAAC6G,OAAO,CAAC;MACzB,CAAC,MAAM;QACH,MAAMpD,SAAS,GAAG,MAAMjB,QAAQ,CAACkB,IAAI,CAAC,CAAC;QACvC5B,cAAc,CAAC,qBAAqB2B,SAAS,EAAE,EAAE,IAAI,CAAC;MAC1D;IACJ,CAAC,CAAC,OAAOH,KAAK,EAAE;MACZxB,cAAc,CAAC,8BAA8BwB,KAAK,CAAClD,OAAO,EAAE,EAAE,IAAI,CAAC;IACvE;EACJ,CAAC;EAED,MAAM0G,qBAAqB,GAAIlD,SAAS,IAAK;IACzCjC,qBAAqB,CAACmC,IAAI,IACtBA,IAAI,CAACyC,QAAQ,CAAC3C,SAAS,CAAC,GAClBE,IAAI,CAACS,MAAM,CAACrC,EAAE,IAAIA,EAAE,KAAK0B,SAAS,CAAC,GACnC,CAAC,GAAGE,IAAI,EAAEF,SAAS,CAC7B,CAAC;EACL,CAAC;EAED,MAAMmD,eAAe,GAAIN,CAAC,IAAK;IAC3B,IAAIA,CAAC,CAACO,MAAM,CAACC,OAAO,EAAE;MAClBtF,qBAAqB,CAACzB,YAAY,CAAC4E,GAAG,CAACJ,CAAC,IAAIA,CAAC,CAACL,GAAG,CAAC,CAAC;IACvD,CAAC,MAAM;MACH1C,qBAAqB,CAAC,EAAE,CAAC;IAC7B;EACJ,CAAC;EAED,MAAMuF,kBAAkB,GAAGA,CAAA,KAAM;IAC7BrF,QAAQ,CAAC,WAAW,EAAE;MAAEsF,KAAK,EAAE;QAAE3F,gBAAgB;QAAEE;MAAmB;IAAE,CAAC,CAAC;EAC9E,CAAC;EAED,oBACI9B,OAAA;IAAKwH,SAAS,EAAC,yBAAyB;IAAAC,QAAA,gBACpCzH,OAAA;MAAQ0H,OAAO,EAAEA,CAAA,KAAMzF,QAAQ,CAAC,CAAC,CAAC,CAAE;MAACuF,SAAS,EAAC,UAAU;MAAAC,QAAA,gBACrDzH,OAAA;QAAGwH,SAAS,EAAC;MAAmB;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,kBACzC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAQ,CAAC,eACT9H,OAAA;MAAAyH,QAAA,EAAI;IAAgB;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EACxBtH,OAAO,iBAAIR,OAAA;MAAGwH,SAAS,EAAC,eAAe;MAAAC,QAAA,EAAEjH;IAAO;MAAAmH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,EAErDxH,YAAY,CAAC2E,MAAM,GAAG,CAAC,gBACpBjF,OAAA;MAAKwH,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACtBzH,OAAA;QAAKwH,SAAS,EAAC,mBAAmB;QAAAC,QAAA,gBAC9BzH,OAAA;UAAK+H,KAAK,EAAE;YAAEC,OAAO,EAAE,MAAM;YAAEC,UAAU,EAAE,QAAQ;YAAEC,YAAY,EAAE;UAAG,CAAE;UAAAT,QAAA,gBACpEzH,OAAA;YACImI,IAAI,EAAC,UAAU;YACfd,OAAO,EAAEvF,kBAAkB,CAACmD,MAAM,KAAK3E,YAAY,CAAC2E,MAAM,IAAI3E,YAAY,CAAC2E,MAAM,GAAG,CAAE;YACtFmD,QAAQ,EAAEjB,eAAgB;YAC1BY,KAAK,EAAE;cAAEM,WAAW,EAAE;YAAE;UAAE;YAAAV,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAC7B,CAAC,eACF9H,OAAA;YAAAyH,QAAA,EAAM;UAAW;YAAAE,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAM,CAAC;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OACvB,CAAC,EACLxH,YAAY,CAAC4E,GAAG,CAACV,OAAO;UAAA,IAAA8D,qBAAA;UAAA,oBACrBtI,OAAA;YAAuBwH,SAAS,EAAC,WAAW;YAAAC,QAAA,gBACxCzH,OAAA;cACImI,IAAI,EAAC,UAAU;cACfd,OAAO,EAAEvF,kBAAkB,CAAC6E,QAAQ,CAACnC,OAAO,CAACC,GAAG,CAAE;cAClD2D,QAAQ,EAAEA,CAAA,KAAMlB,qBAAqB,CAAC1C,OAAO,CAACC,GAAG,CAAE;cACnD8D,QAAQ,EAAE/D,OAAO,CAACO,KAAK,KAAK,CAAE,CAAC;YAAA;cAAA4C,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAClC,CAAC,eACF9H,OAAA;cACIwH,SAAS,EAAC,mBAAmB;cAC7BO,KAAK,EAAEvD,OAAO,CAACgE,SAAS,GAAG;gBACvBC,eAAe,EAAE,OAAOjE,OAAO,CAACgE,SAAS,GAAG;gBAC5CE,cAAc,EAAE,OAAO;gBACvBC,gBAAgB,EAAE,WAAW;gBAC7BC,kBAAkB,EAAE;cACxB,CAAC,GAAG,CAAC,CAAE;cAAAnB,QAAA,GACN,CAACjD,OAAO,CAACgE,SAAS,iBAAIxI,OAAA;gBAAKwH,SAAS,EAAC;cAAoB;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAM,CAAC,EAChEtD,OAAO,CAACO,KAAK,KAAK,CAAC,iBAChB/E,OAAA;gBAAK6I,GAAG,EAAC,cAAc;gBAACC,GAAG,EAAC,UAAU;gBAACtB,SAAS,EAAC;cAAkB;gBAAAG,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAE,CACxE;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACN9H,OAAA;cAAKwH,SAAS,EAAC,mBAAmB;cAAAC,QAAA,gBAC9BzH,OAAA;gBAAAyH,QAAA,EAAKjD,OAAO,CAACuE;cAAI;gBAAApB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAK,CAAC,eACvB9H,OAAA;gBAAGwH,SAAS,EAAC,mBAAmB;gBAAAC,QAAA,GAAC,oBAAU,EAACjD,OAAO,CAACwE,SAAS;cAAA;gBAAArB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eAClE9H,OAAA;gBAAGwH,SAAS,EAAC,OAAO;gBAAAC,QAAA,GAAEjD,OAAO,CAACoB,KAAK,CAACqD,cAAc,CAAC,OAAO,CAAC,EAAC,MAAI;cAAA;gBAAAtB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG,CAAC,eACpE9H,OAAA;gBAAGwH,SAAS,EAAC,OAAO;gBAAAC,QAAA,GAAC,gBAAS,EAACjD,OAAO,CAACO,KAAK;cAAA;gBAAA4C,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAI,CAAC,eACjD9H,OAAA;gBAAKwH,SAAS,EAAC,SAAS;gBAAAC,QAAA,eACpBzH,OAAA;kBAAKwH,SAAS,EAAC,iBAAiB;kBAAAC,QAAA,EAC1B,EAAAa,qBAAA,GAAA5G,iBAAiB,CAAC8C,OAAO,CAACC,GAAG,CAAC,cAAA6D,qBAAA,uBAA9BA,qBAAA,CAAgCrD,MAAM,IAAG,CAAC,gBACxCjF,OAAA;oBACIkJ,KAAK,EAAEtH,gBAAgB,CAAC4C,OAAO,CAACC,GAAG,CAAC,IAAI,EAAG;oBAC3C2D,QAAQ,EAAGvB,CAAC,IAAKxC,mBAAmB,CAACG,OAAO,CAACC,GAAG,EAAEoC,CAAC,CAACO,MAAM,CAAC8B,KAAK,CAAE;oBAClE1B,SAAS,EAAC,gBAAgB;oBAAAC,QAAA,gBAE1BzH,OAAA;sBAAQkJ,KAAK,EAAC,EAAE;sBAAAzB,QAAA,EAAC;oBAAY;sBAAAE,QAAA,EAAAC,YAAA;sBAAAC,UAAA;sBAAAC,YAAA;oBAAA,OAAQ,CAAC,EACrC,CAACpG,iBAAiB,CAAC8C,OAAO,CAACC,GAAG,CAAC,IAAI,EAAE,EAAES,GAAG,CAACgB,OAAO,IAAI;sBACnD,MAAMiD,MAAM,GAAG,CAACjD,OAAO,CAACG,aAAa,IAAK7B,OAAO,CAACoB,KAAK,GAAGpB,OAAO,CAACY,QAAQ,IAAKc,OAAO,CAACG,aAAa;sBACpG,MAAM+C,WAAW,GAAGlD,OAAO,CAACI,YAAY,KAAK,YAAY,GACnD,QAAQJ,OAAO,CAACK,aAAa,GAAG,GAChC,QAAQL,OAAO,CAACK,aAAa,CAAC0C,cAAc,CAAC,OAAO,CAAC,MAAM;sBACjE,MAAMI,YAAY,GAAGnD,OAAO,CAACG,aAAa,GACpC,eAAeH,OAAO,CAACG,aAAa,CAAC4C,cAAc,CAAC,OAAO,CAAC,OAAO,GACnE,EAAE;sBAER,oBACIjJ,OAAA;wBAEIkJ,KAAK,EAAEhD,OAAO,CAAC5D,EAAG;wBAClBiG,QAAQ,EAAE,CAACY,MAAO;wBAAA1B,QAAA,GAEjB2B,WAAW,EAAEC,YAAY,EAAE,CAACF,MAAM,GAAG,uBAAuB,GAAG,EAAE;sBAAA,GAJ7DjD,OAAO,CAAC5D,EAAE;wBAAAqF,QAAA,EAAAC,YAAA;wBAAAC,UAAA;wBAAAC,YAAA;sBAAA,OAKX,CAAC;oBAEjB,CAAC,CAAC;kBAAA;oBAAAH,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OACE,CAAC,gBAET9H,OAAA;oBAAKwH,SAAS,EAAC,oBAAoB;oBAAAC,QAAA,EAAC;kBAEpC;oBAAAE,QAAA,EAAAC,YAAA;oBAAAC,UAAA;oBAAAC,YAAA;kBAAA,OAAK;gBACR;kBAAAH,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OACA;cAAC;gBAAAH,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OACL,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACL,CAAC,eACN9H,OAAA;cAAKwH,SAAS,EAAC,kBAAkB;cAAAC,QAAA,gBAC7BzH,OAAA;gBAAQ0H,OAAO,EAAEA,CAAA,KAAMvC,oBAAoB,CAACX,OAAO,CAACC,GAAG,EAAED,OAAO,CAACY,QAAQ,GAAG,CAAC,CAAE;gBAAAqC,QAAA,EAAC;cAAC;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC,eAC1F9H,OAAA;gBAAAyH,QAAA,EAAOjD,OAAO,CAACY;cAAQ;gBAAAuC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAO,CAAC,eAC/B9H,OAAA;gBAAQ0H,OAAO,EAAEA,CAAA,KAAMvC,oBAAoB,CAACX,OAAO,CAACC,GAAG,EAAED,OAAO,CAACY,QAAQ,GAAG,CAAC,CAAE;gBAAAqC,QAAA,EAAC;cAAC;gBAAAE,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAQ,CAAC;YAAA;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACzF,CAAC,eACN9H,OAAA;cAAKwH,SAAS,EAAC,YAAY;cAAAC,QAAA,EACtB7F,gBAAgB,CAAC4C,OAAO,CAACC,GAAG,CAAC,gBAC1BzE,OAAA,CAAAE,SAAA;gBAAAuH,QAAA,gBACIzH,OAAA;kBAAGwH,SAAS,EAAC,gBAAgB;kBAAAC,QAAA,GACxB,CAACjD,OAAO,CAACoB,KAAK,GAAGpB,OAAO,CAACY,QAAQ,EAAE6D,cAAc,CAAC,OAAO,CAAC,EAAC,MAChE;gBAAA;kBAAAtB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC,eACJ9H,OAAA;kBAAGwH,SAAS,EAAC,kBAAkB;kBAAAC,QAAA,GAC1B/B,kBAAkB,CAAClB,OAAO,CAAC,CAACyE,cAAc,CAAC,OAAO,CAAC,EAAC,MACzD;gBAAA;kBAAAtB,QAAA,EAAAC,YAAA;kBAAAC,UAAA;kBAAAC,YAAA;gBAAA,OAAG,CAAC;cAAA,eACN,CAAC,gBAEH9H,OAAA;gBAAGwH,SAAS,EAAC,cAAc;gBAAAC,QAAA,GACtB,CAACjD,OAAO,CAACoB,KAAK,GAAGpB,OAAO,CAACY,QAAQ,EAAE6D,cAAc,CAAC,OAAO,CAAC,EAAC,MAChE;cAAA;gBAAAtB,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA,OAAG;YACN;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OACA,CAAC,eACN9H,OAAA;cAAQ0H,OAAO,EAAEA,CAAA,KAAMpC,mBAAmB,CAACd,OAAO,CAACC,GAAG,CAAE;cAAC+C,SAAS,EAAC,YAAY;cAAAC,QAAA,EAAC;YAAG;cAAAE,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,OAAQ,CAAC;UAAA,GAnFtFtD,OAAO,CAACC,GAAG;YAAAkD,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAoFhB,CAAC;QAAA,CACT,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eACN9H,OAAA;QAAIwH,SAAS,EAAC,YAAY;QAAAC,QAAA,GAAC,uBAAW,EAACjB,cAAc,CAAC,CAAC,CAACyC,cAAc,CAAC,OAAO,CAAC,EAAC,MAAI;MAAA;QAAAtB,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eACzF9H,OAAA;QAAQwH,SAAS,EAAC,iBAAiB;QAACE,OAAO,EAAEJ,kBAAmB;QAACiB,QAAQ,EAAEzG,kBAAkB,CAACmD,MAAM,KAAK,CAAE;QAAAwC,QAAA,EAAC;MAE5G;QAAAE,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACR,CAAC,gBAEN9H,OAAA;MAAAyH,QAAA,EAAG;IAAc;MAAAE,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OAAG,CACvB;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACA,CAAC;AAEd;AAACzH,EAAA,CA5ZQF,YAAY;EAAA,QAeAL,WAAW;AAAA;AAAAwJ,EAAA,GAfvBnJ,YAAY;AA8ZrB,eAAeA,YAAY;AAAC,IAAAmJ,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}